<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if chapter.title and novel.title %}{{ chapter.title }} - {{ novel.title }} | Free Novel Online - NovelVibe{% else %}Reading - Free Novel Online - NovelVibe{% endif %}</title>
    <meta name="description" content="{% if chapter.summary %}{{ chapter.summary }}{% else %}Read {{ novel.title }} Chapter {{ chapter.number }} on NovelVibe - Free werewolf romance novels{% endif %}">
    <meta name="keywords" content="free novel online, {% if novel.tags %}{{ novel.tags|join(', ') }}, {% endif %}novel updates, light novel, read novel free, online novel, romance novel">
    <meta name="robots" content="index, follow">
    
    {% if timestamps %}
    <meta property="article:published_time" content="{{ timestamps.created_iso }}">
    <meta property="article:modified_time" content="{{ timestamps.modified_iso }}">
    <meta name="date" content="{{ timestamps.modified_date }}">
    <meta name="last-modified" content="{{ timestamps.modified_readable }}">
    {% endif %}
    
    <meta property="og:title" content="{% if chapter.title %}{{ chapter.title }}{% else %}Chapter {{ chapter.number }}{% endif %}">
    <meta property="og:description" content="{% if chapter.summary %}{{ chapter.summary }}{% else %}Read {{ novel.title }} online for free{% endif %}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="{{ canonical_url }}">
    <meta property="og:image" content="{{ novel.cover_url if novel.cover_url else site_url + '/assets/images/default-cover.jpg' }}">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{% if chapter.title %}{{ chapter.title }}{% else %}Chapter {{ chapter.number }}{% endif %}">
    <meta name="twitter:description" content="{% if chapter.summary %}{{ chapter.summary }}{% else %}Read {{ novel.title }} online{% endif %}">
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="canonical" href="{{ canonical_url }}">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KM9R2XBQSL"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-KM9R2XBQSL');</script>
    <script src="/assets/js/analytics.js" defer></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/chapter.css">
    
    {% if timestamps %}
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"{{ chapter.title }} - {{ novel.title }}","author":{"@type":"Person","name":"{{ novel.author }}"},"datePublished":"{{ timestamps.created_iso }}","dateModified":"{{ timestamps.modified_iso }}","publisher":{"@type":"Organization","name":"NovelVibe","url":"{{ site_url }}"},"url":"{{ canonical_url }}"}</script>
    {% endif %}
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"{{ site_url }}/"},{"@type":"ListItem","position":2,"name":"{{ novel.title }}","item":"{{ site_url }}{{ novel.url }}"},{"@type":"ListItem","position":3,"name":"Chapter {{ chapter.number }}","item":"{{ canonical_url }}"}]}</script>
    <script src="https://analytics.ahrefs.com/analytics.js" data-key="E2ZZe80dfDLAEGhT2iI37A" async></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="left-header">
                    <a href="{{ novel.url }}" class="btn" id="back-btn"><i class="fas fa-chevron-left"></i></a>
                    <a href="/" class="logo">NovelVibe</a>
                </div>
                <div class="right-header">
                    <button class="theme-toggle" id="theme-btn" aria-label="Toggle theme"></button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <h1 class="chapter-title">{{ chapter.title if chapter.title else 'Chapter ' + chapter.number|string }}</h1>
            <div class="content font-medium">
                {% for paragraph in chapter.content.split('\n') %}
                {% if paragraph.strip() %}
                <p>{{ paragraph.strip() }}</p>
                {% endif %}
                {% endfor %}
            </div>
            
            <div class="font-controls">
                <button class="font-btn" id="small-font">A</button>
                <button class="font-btn active" id="medium-font">A</button>
                <button class="font-btn" id="large-font">A</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                {% if prev_chapter %}
                <a href="{{ prev_chapter.url }}" class="nav-btn" id="prev-chapter"><i class="fas fa-arrow-left"></i> Previous</a>
                {% else %}
                <button class="nav-btn" disabled><i class="fas fa-arrow-left"></i> Previous</button>
                {% endif %}
                
                {% if next_chapter %}
                <a href="{{ next_chapter.url }}" class="nav-btn" id="next-chapter">Next <i class="fas fa-arrow-right"></i></a>
                {% else %}
                <button class="nav-btn" disabled>Next <i class="fas fa-arrow-right"></i></button>
                {% endif %}
            </div>
        </div>
    </footer>
    
    <script>
    const NEXT_DOMAIN='{{ site.next_chapter_domain|default("") }}';
    // Immediate next button redirect handler
    if(NEXT_DOMAIN){
        window.addEventListener('load',function(){
            const n=document.getElementById('next-chapter');
            if(n){
                n.onclick=function(e){
                    e.preventDefault();
                    try{
                        const p=new URL(this.href,location.origin).pathname;
                        location.href=NEXT_DOMAIN+p;
                    }catch(err){location.href=this.href;}
                };
            }
        });
    }
    </script>
    <script src="/assets/js/chapter.js" defer></script>
</body>
</html>
